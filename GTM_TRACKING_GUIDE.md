# RIDE JOB応募フォーム ファネル分析設定ガイド

## 概要

RIDE JOB応募フォームにユーザーの行動追跡機能を実装しました。これにより、各ステップでの離脱率やコンバージョン率を詳細に分析できるようになります。

## 実装した機能

### 📊 追跡できる内容

1. **ステップ進行状況**
   - ユーザーがどのステップまで進んだか
   - 各ステップでどのくらいの時間を費やしたか

2. **離脱ポイントの特定**
   - どのステップで最も多くのユーザーが離脱するか
   - フォーム途中での離脱率

3. **コンバージョン率**
   - 全体の申込完了率
   - ステップ別の通過率

### 🔄 フォームの流れと追跡ポイント

```
【ステップ1】生年月日入力
    ↓ (step_complete: step_1)
【ステップ2】氏名入力
    ↓ (step_complete: step_2)  
【ステップ3】郵便番号・電話番号入力・送信
    ↓ (form_submit)
【完了画面】申込完了
    ↓ (form_complete)
```

## 送信されるデータ

### 📝 イベント一覧

| イベント名 | 送信タイミング | 用途 |
|-----------|--------------|------|
| `step_view` | ステップ表示時 | ファネル分析 |
| `step_complete` | ステップ完了時 | 進行率測定 |
| `form_submit` | フォーム送信時 | 送信率測定 |
| `form_complete` | 完了画面表示時 | 最終CV測定 |
| `step_abandon` | ページ離脱時 | 離脱率測定 |

### 📋 送信されるデータの詳細

**ステップ関連のイベント:**
```javascript
{
  'event': 'step_view',           // イベント名
  'step_name': 'step_1',          // ステップ名（step_1, step_2, step_3）
  'step_number': 1                // ステップ番号（1, 2, 3）
}
```

**フォーム送信関連のイベント:**
```javascript
{
  'event': 'form_submit',         // イベント名
  'form_name': 'ridejob_application'  // フォーム名
}
```

## GTM側で必要な設定

### ⚙️ 1. トリガーの作成

GTM管理画面で以下のトリガーを作成してください：

#### 📌 ステップ表示トリガー
- **トリガー名**: `Step View`
- **トリガーの種類**: カスタムイベント
- **イベント名**: `step_view`

#### 📌 ステップ完了トリガー
- **トリガー名**: `Step Complete`
- **トリガーの種類**: カスタムイベント
- **イベント名**: `step_complete`

#### 📌 フォーム送信トリガー
- **トリガー名**: `Form Submit`
- **トリガーの種類**: カスタムイベント
- **イベント名**: `form_submit`

#### 📌 フォーム完了トリガー
- **トリガー名**: `Form Complete`
- **トリガーの種類**: カスタムイベント
- **イベント名**: `form_complete`

#### 📌 離脱トリガー
- **トリガー名**: `Step Abandon`
- **トリガーの種類**: カスタムイベント
- **イベント名**: `step_abandon`

### 📊 2. 変数の作成

以下の変数を作成してください：

#### 📋 データレイヤー変数

| 変数名 | 変数の種類 | データレイヤーの変数名 |
|-------|-----------|---------------------|
| `Step Name` | データレイヤーの変数 | `step_name` |
| `Step Number` | データレイヤーの変数 | `step_number` |
| `Form Name` | データレイヤーの変数 | `form_name` |

#### 📋 その他の有用な変数

| 変数名 | 変数の種類 | 用途 |
|-------|-----------|-----|
| `Page URL` | 組み込み変数 | ページURLの取得 |
| `Page Title` | 組み込み変数 | ページタイトルの取得 |
| `Click Text` | 組み込み変数 | クリックされたボタンのテキスト |
| `Referrer` | 組み込み変数 | 参照元の取得 |

### 🎯 3. Google Analytics 4の設定

#### タグの作成

**ステップ表示タグ:**
- **タグ名**: `GA4 - Step View`
- **タグの種類**: Google アナリティクス: GA4イベント
- **設定タグ**: [既存のGA4設定タグを選択]
- **イベント名**: `step_view`
- **カスタムパラメータ**:
  - `step_name`: `{{Step Name}}`
  - `step_number`: `{{Step Number}}`
- **トリガー**: `Step View`

**ステップ完了タグ:**
- **タグ名**: `GA4 - Step Complete`
- **タグの種類**: Google アナリティクス: GA4イベント
- **設定タグ**: [既存のGA4設定タグを選択]
- **イベント名**: `step_complete`
- **カスタムパラメータ**:
  - `step_name`: `{{Step Name}}`
  - `step_number`: `{{Step Number}}`
- **トリガー**: `Step Complete`

**フォーム送信タグ:**
- **タグ名**: `GA4 - Form Submit`
- **タグの種類**: Google アナリティクス: GA4イベント
- **設定タグ**: [既存のGA4設定タグを選択]
- **イベント名**: `form_submit`
- **カスタムパラメータ**:
  - `form_name`: `{{Form Name}}`
- **トリガー**: `Form Submit`

**フォーム完了タグ（コンバージョン）:**
- **タグ名**: `GA4 - Form Complete (Conversion)`
- **タグの種類**: Google アナリティクス: GA4イベント
- **設定タグ**: [既存のGA4設定タグを選択]
- **イベント名**: `form_complete`
- **カスタムパラメータ**:
  - `form_name`: `{{Form Name}}`
- **トリガー**: `Form Complete`

**離脱追跡タグ:**
- **タグ名**: `GA4 - Step Abandon`
- **タグの種類**: Google アナリティクス: GA4イベント
- **設定タグ**: [既存のGA4設定タグを選択]
- **イベント名**: `step_abandon`
- **カスタムパラメータ**:
  - `step_name`: `{{Step Name}}`
  - `step_number`: `{{Step Number}}`
- **トリガー**: `Step Abandon`

#### コンバージョンの設定

GA4管理画面で `form_complete` イベントをコンバージョンとして設定してください：

1. GA4の「管理」→「イベント」
2. `form_complete` イベントの「コンバージョンとしてマークを付ける」をオンにする

#### GTMワークスペースの設定

**重要な設定事項:**
1. **ワークスペース名**: `RIDE JOB フォーム追跡設定`
2. **公開前の確認事項**:
   - すべてのトリガーが正しく設定されているか
   - すべての変数が正しく設定されているか  
   - すべてのタグが正しく設定されているか
   - プレビューモードでの動作確認が完了しているか

#### データ保持とプライバシー設定

**GA4での設定:**
1. **データ保持期間**: 2ヶ月または14ヶ月を選択
2. **IP匿名化**: 自動的に有効（GA4の標準機能）
3. **Cookie設定**: 必要に応じてCookie同意バナーと連携

### 📈 4. ファネル分析レポートの設定

GA4の「探索」機能でファネル分析を設定：

1. **新しい探索レポートを作成**
2. **手法**: ファネル探索を選択
3. **ファネルステップ**:
   - ステップ1: `step_view` (step_number = 1)
   - ステップ2: `step_view` (step_number = 2)
   - ステップ3: `step_view` (step_number = 3)
   - ステップ4: `form_complete`

## 📊 分析できる指標

### 主要な指標

1. **全体のコンバージョン率**
   - フォーム訪問者に対する申込完了者の割合

2. **ステップ別通過率**
   - 各ステップを完了したユーザーの割合

3. **離脱率**
   - 各ステップで離脱したユーザーの割合

4. **最も離脱が多いステップ**
   - 改善すべき優先順位の特定

### 活用方法

- **ステップ2で離脱が多い** → 氏名入力の項目を見直し
- **ステップ3で離脱が多い** → 電話番号入力の説明を改善

## 🔍 動作確認方法

### GTMプレビューモードでの確認

1. GTMでプレビューモードを有効化
2. フォームを操作してイベントが送信されるか確認
3. 各ステップで以下のイベントが送信されることを確認：
   - ページ表示時: `step_view`
   - 次へボタンクリック時: `step_complete`
   - 送信ボタンクリック時: `form_submit`
   - 完了画面表示時: `form_complete`

### 詳細な確認手順

1. **ブラウザの開発者ツール確認**:
   ```javascript
   // コンソールで以下を実行してdataLayerを確認
   console.log(dataLayer);
   ```

2. **GTMプレビューでの確認ポイント**:
   - データレイヤーに正しい値が送信されているか
   - 各トリガーが正しく発火しているか
   - タグが正しく配信されているか

3. **GA4デバッグビュー**:
   - GA4管理画面で「DebugView」を有効化
   - リアルタイムでイベントの受信状況を確認

### GA4での確認

1. GA4のリアルタイムレポートで確認
2. 「イベント」セクションでカスタムイベントが表示されるか確認
3. **確認すべきイベント一覧**:
   - `step_view`
   - `step_complete`  
   - `form_submit`
   - `form_complete`
   - `step_abandon`

### トラブルシューティング

#### よくある問題と解決方法

1. **イベントが送信されない**:
   - GTMコンテナが正しく埋め込まれているか確認
   - JavaScript エラーがないか確認
   - トリガーの条件が正しく設定されているか確認

2. **データが GA4 に送信されない**:
   - GA4測定IDが正しく設定されているか確認
   - GA4設定タグが正しく設定されているか確認

3. **パラメータが正しく送信されない**:
   - 変数の設定が正しいか確認  
   - データレイヤーの変数名が正しいか確認

## 📞 サポート

設定に関してご不明な点がございましたら、開発チームまでお気軽にお声かけください。

---

**実装日**: 2025年1月
**バージョン**: 1.0
**対象サイト**: RIDE JOB応募フォーム